<!DOCTYPE html><html class="h-100"><head><title>pageTitle: not defined</title><link rel="stylesheet" href="/stylesheets/style.css"><link rel="stylesheet" href="/bootstrap/bootstrap.min.css"><script src="/bootstrap/bootstrap.bundle.min.js"> </script><script>function getDate() {
  var date = new Date().toLocaleString();
  let arr = date.split(",");
  date = arr[0] + "<br>" + arr[1];

  document.getElementById("timedisplay").innerHTML = date.toLocaleString();
}
setInterval(getDate, 0);
</script><script>var pageProps={};</script></head><body class="h-100"><div class="container-fluid h-100 d-flex flex-column"> <div class="row"><div class="col-3"><img src="/img/logo_bortek.png" alt="Бортек" id="logo"></div><div class="col my-auto mx-auto "><div class="h2 " id="pageTitle">pageTitle: not defined</div></div><div class="col-1 my-auto mx-auto "><div class="h5" id="timedisplay"></div></div><hr></div><div class="row h-100"><div class="col"><div class="h-100" id="pageBody"><p>--------------------- debugging info -----------------------------</p><pre>{&quot;ln&quot;:&quot;ClassTasksManager(thermal)::&quot;,&quot;id&quot;:&quot;TasksManager&quot;,&quot;comment&quot;:{&quot;ua&quot;:&quot;Створення програми&quot;,&quot;en&quot;:&quot;Program creation&quot;,&quot;ru&quot;:&quot;Создание прграммы&quot;},&quot;header&quot;:{&quot;ua&quot;:&quot;Створення програми&quot;,&quot;en&quot;:&quot;Program creating&quot;,&quot;ru&quot;:&quot;Создание программы&quot;},&quot;types&quot;:{&quot;id&quot;:&quot;taskType&quot;,&quot;ln&quot;:&quot;ClassRegister(taskType)::&quot;,&quot;header&quot;:{&quot;ua&quot;:&quot;Виберіть тип кроку&quot;,&quot;en&quot;:&quot;Select type of step&quot;,&quot;ru&quot;:&quot;Выберите тип шага&quot;},&quot;type&quot;:&quot;select&quot;,&quot;value&quot;:null,&quot;comment&quot;:{&quot;ua&quot;:&quot;Доступні задачі&quot;,&quot;en&quot;:&quot;Avaliable tasks&quot;,&quot;ru&quot;:&quot;Доступные задачи &quot;},&quot;regs&quot;:{&quot;empty&quot;:{&quot;id&quot;:&quot;empty&quot;,&quot;ln&quot;:&quot;ClassRegister(empty)::&quot;,&quot;header&quot;:{&quot;ua&quot;:&quot;Виберіть тип кроку&quot;,&quot;en&quot;:&quot;Select type of step&quot;,&quot;ru&quot;:&quot;Выберите тип шага&quot;},&quot;type&quot;:&quot;taskType&quot;,&quot;value&quot;:null,&quot;comment&quot;:{&quot;ua&quot;:&quot;Тип кроку не вказано&quot;,&quot;en&quot;:&quot;Type of the Step not defined&quot;,&quot;ru&quot;:&quot;Тип шага не указан&quot;},&quot;regs&quot;:{}},&quot;undefined&quot;:{&quot;ln&quot;:&quot;ClassTaskGeneral()::&quot;,&quot;regs&quot;:{&quot;tT&quot;:{&quot;id&quot;:&quot;tT&quot;,&quot;type&quot;:&quot;number&quot;,&quot;value&quot;:100,&quot;header&quot;:{&quot;ua&quot;:&quot;T,°C&quot;,&quot;en&quot;:&quot;T,°C&quot;,&quot;ru&quot;:&quot;T,°C&quot;},&quot;title&quot;:{&quot;ua&quot;:&quot;Цільова температура, °С&quot;,&quot;en&quot;:&quot;Task temperature, °С&quot;,&quot;ru&quot;:&quot;Целевая температура, °С&quot;},&quot;min&quot;:0,&quot;max&quot;:150},&quot;errTmin&quot;:{&quot;id&quot;:&quot;errTmin&quot;,&quot;header&quot;:{&quot;ua&quot;:&quot;min dT,°C&quot;,&quot;en&quot;:&quot;min dT,°C&quot;,&quot;ru&quot;:&quot;min dT,°C&quot;},&quot;type&quot;:&quot;number&quot;,&quot;value&quot;:-50,&quot;title&quot;:{&quot;ua&quot;:&quot;Максимальне відхилення температури вниз,°С&quot;,&quot;en&quot;:&quot;Limit of low temperature,°С&quot;,&quot;ru&quot;:&quot;Максимальное отклонение температуры вниз,°С&quot;},&quot;min&quot;:0,&quot;max&quot;:-100},&quot;errTmax&quot;:{&quot;id&quot;:&quot;errTmax&quot;,&quot;header&quot;:{&quot;ua&quot;:&quot;max dT,°C&quot;,&quot;en&quot;:&quot;max dT,°C&quot;,&quot;ru&quot;:&quot;max dT,°C&quot;},&quot;type&quot;:&quot;number&quot;,&quot;value&quot;:25,&quot;title&quot;:{&quot;ua&quot;:&quot;Максимальне перевищення температури,°С&quot;,&quot;en&quot;:&quot;Limit of high temperature,°С&quot;,&quot;ru&quot;:&quot;Максимальное превышение температуры,°С&quot;},&quot;min&quot;:0,&quot;max&quot;:100},&quot;regMode&quot;:{&quot;id&quot;:&quot;regMode&quot;,&quot;header&quot;:{&quot;ua&quot;:&quot;Регулювання&quot;,&quot;en&quot;:&quot;Regulation&quot;,&quot;ru&quot;:&quot;Регулирование&quot;},&quot;type&quot;:&quot;select&quot;,&quot;value&quot;:&quot;pos&quot;,&quot;regs&quot;:[{&quot;id&quot;:&quot;pos&quot;,&quot;header&quot;:{&quot;ua&quot;:&quot;Позиційний&quot;,&quot;en&quot;:&quot;Positional&quot;,&quot;ru&quot;:&quot;Позиционный&quot;},&quot;type&quot;:&quot;selectItem&quot;,&quot;regs&quot;:{&quot;o&quot;:{&quot;id&quot;:&quot;o&quot;,&quot;header&quot;:{&quot;ua&quot;:&quot;Різниця&quot;,&quot;en&quot;:&quot;Position&quot;,&quot;ru&quot;:&quot;Рассогласование&quot;},&quot;type&quot;:&quot;number&quot;,&quot;value&quot;:-2,&quot;title&quot;:{&quot;ua&quot;:&quot;Неузгодження температур,°С&quot;,&quot;en&quot;:&quot;Temperature difference,°С&quot;,&quot;ru&quot;:&quot;Рассогласование температур,°С&quot;},&quot;min&quot;:-20,&quot;max&quot;:0}},&quot;title&quot;:{&quot;ua&quot;:&quot;Позиційний закон регулювання&quot;,&quot;en&quot;:&quot;Positional regulation&quot;,&quot;ru&quot;:&quot;Позиционный закон регуллирования&quot;}},{&quot;id&quot;:&quot;pid&quot;,&quot;header&quot;:{&quot;ua&quot;:&quot;ПІД&quot;,&quot;en&quot;:&quot;PID&quot;,&quot;ru&quot;:&quot;ПИД&quot;},&quot;type&quot;:&quot;select&quot;,&quot;regs&quot;:{&quot;o&quot;:{&quot;id&quot;:&quot;o&quot;,&quot;header&quot;:{&quot;ua&quot;:&quot;П&quot;,&quot;en&quot;:&quot;P&quot;,&quot;ru&quot;:&quot;П&quot;},&quot;type&quot;:&quot;number&quot;,&quot;value&quot;:5,&quot;title&quot;:{&quot;ua&quot;:&quot;Пропорційна складова&quot;,&quot;en&quot;:&quot;Proportional gain&quot;,&quot;ru&quot;:&quot;Пропорциональная составляющая&quot;},&quot;min&quot;:0,&quot;max&quot;:100},&quot;i&quot;:{&quot;id&quot;:&quot;ti&quot;,&quot;header&quot;:{&quot;ua&quot;:&quot;І&quot;,&quot;en&quot;:&quot;I&quot;,&quot;ru&quot;:&quot;И&quot;},&quot;type&quot;:&quot;number&quot;,&quot;value&quot;:5,&quot;title&quot;:{&quot;ua&quot;:&quot;Інтегральна складова&quot;,&quot;en&quot;:&quot;Integral gain&quot;,&quot;ru&quot;:&quot;Интегральная составляющая&quot;},&quot;min&quot;:0,&quot;max&quot;:100},&quot;d&quot;:{&quot;id&quot;:&quot;td&quot;,&quot;header&quot;:{&quot;ua&quot;:&quot;Д&quot;,&quot;en&quot;:&quot;D&quot;,&quot;ru&quot;:&quot;Д&quot;},&quot;type&quot;:&quot;number&quot;,&quot;value&quot;:5,&quot;title&quot;:{&quot;ua&quot;:&quot;Диференційна складова&quot;,&quot;en&quot;:&quot;Differencial gain&quot;,&quot;ru&quot;:&quot;Диферинциальная составляющая&quot;},&quot;min&quot;:0,&quot;max&quot;:100}},&quot;title&quot;:{&quot;ua&quot;:&quot;ПІД закон регулювання&quot;,&quot;en&quot;:&quot;PID regulation&quot;,&quot;ru&quot;:&quot;ПИД закон регуллирования&quot;}}],&quot;title&quot;:{&quot;ua&quot;:&quot;Закон регулювання&quot;,&quot;en&quot;:&quot;Control type&quot;,&quot;ru&quot;:&quot;Закон регулирования&quot;}}},&quot;type&quot;:{&quot;id&quot;:&quot;thermal&quot;,&quot;title&quot;:{&quot;ua&quot;:&quot;Термообробка&quot;,&quot;en&quot;:&quot;Heat treatment&quot;,&quot;ru&quot;:&quot;Термообработка&quot;}},&quot;title&quot;:{&quot;ua&quot;:&quot;undefined&quot;,&quot;en&quot;:&quot;undefined&quot;,&quot;ru&quot;:&quot;undefined&quot;}}}},&quot;list&quot;:[]}  </pre><p>--------------------- debugging info -----------------------------</p><div class="row"><div class="col"><h3>Завдання</h3></div></div><div class="row"><div class="col" id="tasksContainer"></div></div><script>const lang= 'ua'; 
const tasks={};
tasks.types = JSON.parse(  '{"id":"taskType","ln":"ClassRegister(taskType)::","header":{"ua":"Виберіть тип кроку","en":"Select type of step","ru":"Выберите тип шага"},"type":"select","value":null,"comment":{"ua":"Доступні задачі","en":"Avaliable tasks","ru":"Доступные задачи "},"regs":{"empty":{"id":"empty","ln":"ClassRegister(empty)::","header":{"ua":"Виберіть тип кроку","en":"Select type of step","ru":"Выберите тип шага"},"type":"taskType","value":null,"comment":{"ua":"Тип кроку не вказано","en":"Type of the Step not defined","ru":"Тип шага не указан"},"regs":{}},"undefined":{"ln":"ClassTaskGeneral()::","regs":{"tT":{"id":"tT","type":"number","value":100,"header":{"ua":"T,°C","en":"T,°C","ru":"T,°C"},"title":{"ua":"Цільова температура, °С","en":"Task temperature, °С","ru":"Целевая температура, °С"},"min":0,"max":150},"errTmin":{"id":"errTmin","header":{"ua":"min dT,°C","en":"min dT,°C","ru":"min dT,°C"},"type":"number","value":-50,"title":{"ua":"Максимальне відхилення температури вниз,°С","en":"Limit of low temperature,°С","ru":"Максимальное отклонение температуры вниз,°С"},"min":0,"max":-100},"errTmax":{"id":"errTmax","header":{"ua":"max dT,°C","en":"max dT,°C","ru":"max dT,°C"},"type":"number","value":25,"title":{"ua":"Максимальне перевищення температури,°С","en":"Limit of high temperature,°С","ru":"Максимальное превышение температуры,°С"},"min":0,"max":100},"regMode":{"id":"regMode","header":{"ua":"Регулювання","en":"Regulation","ru":"Регулирование"},"type":"select","value":"pos","regs":[{"id":"pos","header":{"ua":"Позиційний","en":"Positional","ru":"Позиционный"},"type":"selectItem","regs":{"o":{"id":"o","header":{"ua":"Різниця","en":"Position","ru":"Рассогласование"},"type":"number","value":-2,"title":{"ua":"Неузгодження температур,°С","en":"Temperature difference,°С","ru":"Рассогласование температур,°С"},"min":-20,"max":0}},"title":{"ua":"Позиційний закон регулювання","en":"Positional regulation","ru":"Позиционный закон регуллирования"}},{"id":"pid","header":{"ua":"ПІД","en":"PID","ru":"ПИД"},"type":"select","regs":{"o":{"id":"o","header":{"ua":"П","en":"P","ru":"П"},"type":"number","value":5,"title":{"ua":"Пропорційна складова","en":"Proportional gain","ru":"Пропорциональная составляющая"},"min":0,"max":100},"i":{"id":"ti","header":{"ua":"І","en":"I","ru":"И"},"type":"number","value":5,"title":{"ua":"Інтегральна складова","en":"Integral gain","ru":"Интегральная составляющая"},"min":0,"max":100},"d":{"id":"td","header":{"ua":"Д","en":"D","ru":"Д"},"type":"number","value":5,"title":{"ua":"Диференційна складова","en":"Differencial gain","ru":"Диферинциальная составляющая"},"min":0,"max":100}},"title":{"ua":"ПІД закон регулювання","en":"PID regulation","ru":"ПИД закон регуллирования"}}],"title":{"ua":"Закон регулювання","en":"Control type","ru":"Закон регулирования"}}},"type":{"id":"thermal","title":{"ua":"Термообробка","en":"Heat treatment","ru":"Термообработка"}},"title":{"ua":"undefined","en":"undefined","ru":"undefined"}}}}' );
tasks.list = JSON.parse(  '[]' );
tasks.container = document.getElementById( 'tasksContainer' );</script><script> // створюємо прапорці трасування, так як в нас багато файлів нам потрыбно в кожному
// з них вмикати трасування окремо від інших , тому кожний файл з кодом
// перед виконанням свого коду запамятовує поточне значення trace в beforeTrace: 'beforeTrace=trace'
// після завершення відновлює попереднє значення 'trace=beforeTrace', таким чином модулі не будуть заважати іншим
let trace = 1,
  beforeTrace = 0;

/**
 *
 * @param {String} prefix  - префікс
 * @param {Object} reg - обєкт в якому визначена властивість "id"
 * @returns {String} "prefix__reg.id" - два підкреслення (щоб легко відділяти id регістру)
 */

tasks.createId = function (prefix, reg) {
  return (id = prefix + "__" + reg.id);
};

tasks.renderRegs = function (prefix, regsList) {
  let trace = 1,
    ln = "tasks.renderRegs()::";
  for (let key in regsList) {
    trace ? console.log(ln + "key=" + key) : null;
    if (regsList.hasOwnProperty(key)) {
      if (trace) {
        console.dir(regsList[key]);
      }
    }
  }
};

tasks.elementsTypes = {};

class ClassCreateElement {
  constructor(props = {}) {
    this.ln = "ClassCreateElement()::";
    let trace = 1,
      ln = this.ln + "constructror()::";
    trace ? console.log(ln + "props=") : null;
    trace ? console.dir(props) : null;
    // -- тег основного елемента, щоб створити шаблон
    this.tag = props.tag;
    // -- префікс -----
    this.prefix = props.prefix;
    // -- регістр
    this.reg = props.reg;
    // -- id - елементу
    this.id = props.prefix + "__" + props.reg.id; //два підкреслення (щоб легко відділяти id регістру)
    // контайнер для всього елементу
    this.div = document.createElement("div");
    this.div.classList.add = "form-group column";
    // ---- <label> --------
    this.label = document.createElement("label");
    this.label.setAttribute("for", this.id);
    this.label.classList.add("h6");
    this.label.innerHTML = reg.header[lang];
    // ---- <title> --------
    this.note = document.createElement("small");
    this.title.innerHTML = reg.title[lang];
    // ---- Field --------
    this.field = document.createElement(this.tag);
    this.field.dataset.beforeValue = "";
    this.field.classList.add("form-control");
    this.field.classList.add(prefix);
    this.field.id = this.id;
    this.div.appendChild(this.label);
    this.div.appendChild(this.field);
    this.div.appendChild(this.title);
  }

  onchange(el) {
    let trace = 1,
      ln = this.ln + "onchange()::";
    if (trace) {
      console.log(ln + "this=");
      console.dir(this);
    }
  }
  set(prefix, obj) {}
  get() {}
}

tasks.ClassCreateElement = ClassCreateElement;
// -----------  element: select -------------------
beforeTrace = trace;
trace = 1;

class ClassElementSelect extends ClassCreateElement {
  constructor(props = {}) {
    props.tag = "select";
    super(props);
    this.ln = "ClassElementSelect(" + props.reg.type.id + ")::";
    let trace = 1,
      ln = "ClassElementSelect()::";
    this.regs = this.reg.regs;

    // створюємо список <option>
    let keys = "";
    for (let key in this.reg.regs) {
      let trace = 1;
      trace ? console.log(ln + "key=" + key) : null;
      keys += `<option value='${key}'> ${this.reg.regs[key].type.title[lang]} </option>`;
    }
    this.field.innerHTML = keys;
    // -- обробник зміни значення поля ----------
    this.field.onchange = this.onchange;

    if (trace) {
      console.log(ln + "this=");
      console.dir(this);
    }
  }
  onchange(el) {}
}

tasks.elementsTypes["select"] = ClassElementSelect;

/**
 * Генерує елемент для вибору можливих варіантів
 * @param {String} prefix
 * @param {Object} regsList - список об'єктів з яких потрібно побудувати елемент
 * @returns
 */

tasks.elementsTypes.select.set = function (prefix, regsList) {
  let ln = "select.set::";
  let id = tasks.createId(prefix, regsList.type);
  // --- div
  let div = document.createElement("div");
  div.classList.add = "form-group";
  // --- створюємо <label>
  let label = document.createElement("label");
  label.setAttribute("for", id);
  label.classList.add("h6");
  label.innerHTML = regsList.type.header[lang];
  div.appendChild(label);

  // --- створюємо <select>
  let select = document.createElement("select");
  select.classList.add("form-control");
  label.classList.add(prefix);
  select.id = id;

  select.onchange = function (event) {
    let trace = 1;
    let el = event.target;
    return function () {
      if (trace) {
        console.log(id + "::el.value=");
        console.dir(el.value);

        console.log(id + "::onchange::this=");
        console.dir(this);
        console.log(id + "::onchange::prefix=" + prefix);
        console.dir(prefix);
      }
      tasks.renderRegs(prefix, this[el.value].regs);
    }.bind(regsList.regs, null, prefix)();
  }; //.bind(regsList.regs, null, prefix);
  div.appendChild(select);
  let title = document.createElement("small");
  title.innerHTML = regsList.type.title[lang];
  div.appendChild(title);
  select.dataset.beforeValue = select.value;

  return div;
};

if (trace) {
  // для тестування, створює елемент в контейнері
  let select = tasks.elementsTypes.select.set("st_01", tasks.types);
  tasks.container.appendChild(select);
}

trace = beforeTrace;
</script><div class="row"><div class="col"><button class="btn btn-primary" type="button">Застосувати</button></div></div></div></div></div></div><script src="/bootstrap/bootstrap.min.js"></script></body></html>